
\chapter{总结}
\label{chap:conclusion}

数值模拟在束流动力学研究和加速器设计中非常重要。


%chapter 3
我们在介绍了根据PIC算法编写的粒子模拟程序P-TOPO，主要处理强流加速器中的非线性效应。
P-TOPO的PIC部分和整体正确性都得到了验证，并应用在C-ADS注入器I的RFQ和超导段，分别对其进行了模拟并且与其他程序进行了比较。
模拟结果证明了现有设计的合理性，束团的尺寸和发射度都得到了有效控制，束损以及能散也在合理范围之内，完全满足需求。
之后，我们将继续对P-TOPO进行拓展并加入更多新的功能，以满足强流加速器的各种需求。

%chapter 4
我们在GPU上使用使用CUDA库实现了基于PIC方法的多粒子模拟程序，并对如何避免竞争条件和实现更高性能的GPU代码结构和并行策略进行了介绍。在单个GPU卡上，我们使用普通的家用GPU（GTX 1060）实现了超过50倍的加速。当粒子数较大时，程序在GPU集群上也显示出良好的可扩展性；而当粒子数目较小时其可扩展性较差。
我们也新的CPU架构Cori Knight Landing上实现了PIC程序，并探索了其最佳性能的并行线程配置。通过比较，单GPU运行的程序和使用4或8个节点的程序性能相当。
在未来的研究中，我们将继续扩展此代码并提高效率。

%chapter 5
我们使用CUDA库在GPU上实现了无网格保辛粒子跟踪算法。这个算法能够保障辛条件并有效降低由于网格热效应带来的发射度增长。
在一个普通家用GPU上，程序获得了超过450倍的加速比。同时，我们在GPU集群泰坦上的测试还显示出这种算法有良好的可扩展性，程序的加速比随着GPU数目几乎线性增加。
我们在周期性聚焦结构中使用这个程序进行了几个应用模拟，当工作点远离共振线时，束流不会出现发射度增长，而当其接近共振线时发射度会持续增长。
在未来的研究中，我们将继续扩展此程序，在不同架构的计算机上比较保辛算法的效率。