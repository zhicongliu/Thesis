
\chapter{论文总结与课题研究展望}
\label{chap:conclusion}
%summary
通过本论文的工作，我们对空间电荷效应以及其引起束晕现象有了较为深刻的理解，
并且根据PIC算法编写出了一个新的粒子模拟程序P-TOPO，主要处理强流加速器中的非线性效应。
在程序开发的过程中，我们了解并掌握束流模拟软件背后的计算过程。
本论文还对新的计算空间电荷效应的算法进行了探索。
为了优化程序效率，我们在GPU上并行实现了PIC算法和symplectic算法，在CPU集群上实现了PIC算法，均取得了令人满意的加速比。

本论文文在GPU上使用使用CUDA库实现了基于PIC方法的多粒子模拟程序，并对如何避免竞争条件和实现更高性能的GPU代码结构和并行策略进行了介绍。
在单个GPU卡上，我们使用普通的家用GPU（GTX 1060）实现了超过50倍的加速。
当粒子数较大时，程序在GPU集群上也显示出良好的可扩展性。
我们也在新的CPU架构Knight Landing上实现了PIC程序，并探索了其最佳性能的并行线程配置。
通过PIC程序在CPU与GPU上的运算时间比较，可以看出单GPU运行的程序和使用4或8个节点的程序性能相当。


本文还介绍了一种新型的求解空间电荷效应的算法-Symplectic算法，同时使用CUDA库在GPU上进行了实现。
这个算法能够保障辛条件，同PIC算法相比，~Symplectic算法以增加运算量为代价效降低了由于网格热效应带来的发射度增长。
Symplectic算法非常适合GPU并行化，在一个普通家用GPU上，Symplectic程序获得了超过450倍的加速比。
同时，我们在GPU集群Titan上的测试还显示出这种算法有良好的可扩展性，程序的加速比随着GPU数目几乎线性增加。

P-TOPO程序和各个算法的正确性都得到了验证。
我们在周期性聚焦结构中使用Symplectic程序进行了几个应用模拟，
当工作点远离共振线时，束流不会出现发射度增长；
而当其接近共振线时发射度会持续增长。
P-TOPO程序被应用在了C-ADS注入器I的RFQ和超导段中，本文使用P-TOPO对C-ADS注入器I进行了模拟，并且与其他程序进行了比较。
模拟结果证明了现有设计的合理性，束团的尺寸和发射度都得到了有效控制，束损以及能散也在合理范围之内，完全满足需求。

%expectation
在之后的研究和工作中，我们将继续研究空间电荷效应对强流加速器的影响，
同时对P-TOPO进行拓展并加入更多新的功能，以满足强流束流模拟和动力学研究的各种需求。
我们还将继续提高束流模拟程序效率，研究程序在新型计算机架构上的优化策略，不断对P-TOPO进行更新。
除此之外，我们还希望不断探索新的物理模型和数值算法，考虑其他的物理效应，并将其应用在模拟程序中。